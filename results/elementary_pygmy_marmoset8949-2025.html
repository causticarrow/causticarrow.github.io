<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>2025 elementary_pygmy_marmoset8949 Results - causticarrow.com</title>
        <link rel="stylesheet" href="../style.css" />
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    </head>
    <body>
        <div class="container">
            <aside class="sidebar">
                <input type="text" class="search-bar" placeholder="Search" />
                <ul>
                    <li><a href="../index.html">Home</a></li>
                    <li><a href="https://x.com/causticarrow">ùïè (Twitter)</a></li>

                    <li class="category-header">
                        <span class="category-toggle">Results</span>
                        <ul class="category-content">
                            <li><a href="elementary_pygmy_marmoset8949-2025.html" class="active">2025 NFL elementary_pygmy</a></li>
                            <li><a href="robpizzola-nfl-2024-25.html">2024-25 NFL @robpizzola</a></li>
                            <li><a href="clivebixby41-nfl-2024-25.html">2024-25 NFL @CliveBixby41</a></li>
                            <li><a href="alexcaruso-2024-25.html">2024-25 @AlexCaruso</a></li>
                            <li><a href="raspicks-cbase-2021-24.html">2021-24 CBASE @RASPicks</a></li>
                        </ul>
                    </li>
                </ul>
            </aside>
            <main class="main-content">
                <h1>2025 elementary_pygmy_marmoset8949</h1>
                <div id="chart-container" style="width: 100%; height: 300px">
                    <canvas id="myChart" style="width: 100%; height: 300px"></canvas>
                </div>
                <table class="summary-table">
                    <thead>
                        <tr>
                            <th>n</th>
                            <th>Record</th>
                            <th>Units</th>
                            <th>ROI</th>
                            <th>BTCL</th>
                            <th>No-Vig CLV</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td id="n"></td>
                            <td id="record"></td>
                            <td id="units"></td>
                            <td id="roi"></td>

                            <td id="btcl"></td>
                            <td id="noVigClv"></td>
                        </tr>
                    </tbody>
                </table>
                <table class="detailed-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Play</th>
                            <th>Result</th>
                            <th>Units</th>
                            <th>Score</th>
                            <th>Close</th>
                            <th>No-Vig CLV</th>
                        </tr>
                    </thead>
                    <tbody id="resultsTableBody"></tbody>
                </table>
            </main>
        </div>

        <script>
            document.addEventListener("DOMContentLoaded", function () {
                var data = [
{date: "2025-09-15",sport: "NFL",play: "Justin Herbert Over 227.5 Passing Yards (-115)",result: "Win",score: "242",close: "‚Äî",clv: "0"},
{date: "2025-09-15",sport: "NFL",play: "Tyler Conklin Under 10.5 Longest Reception (-125)",result: "Win",score: "0",close: "‚Äî",clv: "0"},

                ];

                console.log("Data before processing:", data);

                function formatValue(value, isPercentage = false) {
                    if (isPercentage) {
                        if (value === 0) {
                            return "‚Äî";
                        }
                        return value > 0 ? `+${value.toFixed(2)}%` : value < 0 ? `${value.toFixed(2)}%` : "0.00%";
                    } else {
                        return value > 0 ? `+${value.toFixed(2)}` : value < 0 ? `${value.toFixed(2)}` : "0.00";
                    }
                }

    function filterSidebar() {
        var input, filter, ul, li, i;
        input = document.querySelector(".search-bar");
        filter = input.value.toUpperCase();
        ul = document.querySelector(".sidebar ul");
        li = ul.getElementsByTagName("li");

        for (i = 0; i < li.length; i++) {
            var a = li[i].getElementsByTagName("a")[0];
            if (a) {
                var txtValue = li[i].textContent || li[i].innerText;
                if (txtValue.toUpperCase().indexOf(filter) > -1) {
                    li[i].style.display = "";
                } else {
                    var shouldHide = true;
                    li[i].querySelectorAll('*').forEach(node => {
                        if ((node.textContent || node.innerText).toUpperCase().indexOf(filter) > -1) {
                            shouldHide = false;
                        }
                    });
                    li[i].style.display = shouldHide ? "none" : "";
                }
            }
        }
    }

                function calculateUnits(row) {
                    console.log("Processing row for units:", row);
                    if (row.result === "Win") {
                        console.log("Win detected, returning 1 unit");
                        return 1;
                    } else if (row.result === "Loss") {
                        if (row.play.includes("(")) {
                            console.log("Odds found in play:", row.play);
                            var oddsMatch = row.play.match(/\(([-+]?\d+(?:\.\d+)?)\)/);
                            if (oddsMatch) {
                                var odds = parseFloat(oddsMatch[1]);
                                console.log("Parsed odds:", odds);
                                if (odds > 0) {
                                    console.log("Positive odds calculation:", -(100 / odds));
                                    return -(100 / odds);
                                } else {
                                    console.log("Negative odds calculation:", -(Math.abs(odds) / 100));
                                    return -(Math.abs(odds) / 100);
                                }
                            } else {
                                console.log("No odds format found, returning default loss");
                                return -1.1;
                            }
                        } else {
                            console.log("No odds found, returning default loss");
                            return -1.1;
                        }
                    } else {
                        console.log("Push or other result, returning 0");
                        return 0;
                    }
                }

                function calculateRisk(row) {
                    console.log("Processing row for risk:", row);
                    if (row.play.includes("(")) {
                        console.log("Odds found in play:", row.play);
                        var oddsMatch = row.play.match(/\(([-+]?\d+(?:\.\d+)?)\)/);
                        if (oddsMatch) {
                            var odds = parseFloat(oddsMatch[1]);
                            console.log("Parsed odds:", odds);
                            if (odds > 0) {
                                console.log("Positive odds risk calculation:", odds / 100);
                                return odds / 100;
                            } else {
                                console.log("Negative odds risk calculation:", Math.abs(odds) / 100);
                                return Math.abs(odds) / 100;
                            }
                        } else {
                            console.log("No odds format found, returning default risk");
                            return 1.1;
                        }
                    } else {
                        console.log("No odds found, returning default risk");
                        return 1.1;
                    }
                }

                function updateSummaryTable() {
                    let wins = 0,
                        losses = 0,
                        pushes = 0,
                        totalUnits = 0,
                        positiveClv = 0,
                        totalClv = 0,
                        totalRisked = 0;

                    data.forEach((row) => {
                        if (row.result === "Win") {
                            wins++;
                            let units = calculateUnits(row);
                            if (isNaN(units)) {
                                console.error("NaN detected in units calculation for:", row);
                            } else {
                                totalUnits += units;
                            }
                        } else if (row.result === "Loss") {
                            losses++;
                            let units = calculateUnits(row);
                            if (isNaN(units)) {
                                console.error("NaN detected in units calculation for:", row);
                            } else {
                                totalUnits += units;
                            }
                        } else if (row.result === "Push") {
                            pushes++;
                        }
                        let risk = calculateRisk(row);
                        if (isNaN(risk)) {
                            console.error("NaN detected in risk calculation for:", row);
                        } else {
                            totalRisked += risk;
                        }
                        let clvValue = parseFloat(row.clv.replace("%", ""));
                        if (clvValue > 0) positiveClv++;
                        totalClv += clvValue;
                    });

                    console.log("Summary stats:", {
                        wins,
                        losses,
                        pushes,
                        totalUnits,
                        totalRisked,
                        positiveClv,
                        totalClv
                    });

                    let nElement = document.getElementById("n");
                    let recordElement = document.getElementById("record");
                    let unitsElement = document.getElementById("units");
                    let roiElement = document.getElementById("roi");
                    let btclElement = document.getElementById("btcl");
                    let noVigClvElement = document.getElementById("noVigClv");

                    if (nElement) nElement.textContent = data.length;
                    if (recordElement)
                        recordElement.textContent = `${wins} - ${losses} - ${pushes} (${((wins / (wins + losses)) * 100).toFixed(2)}%)`;

                    if (unitsElement) {
                        unitsElement.textContent = formatValue(totalUnits);
                        console.log("Units element content set to:", unitsElement.textContent);
                        unitsElement.style.color = totalUnits > 0 ? "#1ea672" : totalUnits < 0 ? "#ff5252" : "#8c99ad";
                    }

                    if (roiElement) {
                        let roi = (totalUnits / totalRisked) * 100;
                        roiElement.textContent = formatValue(roi, true);
                        console.log("ROI element content set to:", roiElement.textContent);
                        roiElement.style.color = roi > 0 ? "#1ea672" : roi < 0 ? "#ff5252" : "#8c99ad";
                    }

                    // BTCL calculation - show "‚Äî" if exactly 0%
                    let btclPercent = (positiveClv / data.length) * 100;
                    if (btclElement) {
                        if (btclPercent === 0) {
                            btclElement.textContent = "‚Äî";
                        } else {
                            btclElement.textContent = `${btclPercent.toFixed(2)}%`;
                        }
                    }

                    // No-Vig CLV calculation - show "‚Äî" if exactly 0%
                    if (noVigClvElement) {
                        let avgClv = totalClv / data.length;
                        noVigClvElement.textContent = formatValue(avgClv, true);
                        console.log("No-Vig CLV element content set to:", noVigClvElement.textContent);
                        noVigClvElement.style.color = avgClv > 0 ? "#1ea672" : avgClv < 0 ? "#ff5252" : "#8c99ad";
                    }
                }

                function populateDetailedTable() {
                    let tbody = document.getElementById("resultsTableBody");
                    if (!tbody) {
                        console.error("Table body not found");
                        return;
                    }
                    console.log("Table body found, clearing and repopulating", tbody);
                    tbody.innerHTML = "";

                    console.log("Data before sort:", data);
                    data.sort((a, b) => {
                        var dateA = new Date(a.date).getTime();
                        var dateB = new Date(b.date).getTime();

                        if (dateA === dateB) {
                            var rotationA = a.play.match(/^\d+/) ? parseInt(a.play.match(/^\d+/)[0]) : 0;
                            var rotationB = b.play.match(/^\d+/) ? parseInt(b.play.match(/^\d+/)[0]) : 0;
                            return rotationB - rotationA;
                        }

                        return dateB - dateA;
                    });
                    console.log("Data after sort:", data);

                    data.forEach((row, index) => {
                        console.log("Processing row:", index, row);
                        let units = calculateUnits(row);
                        let tr = document.createElement("tr");
                        let unitColor = units > 0 ? "#1ea672" : units < 0 ? "#ff5252" : "#8c99ad";
                        if (formatValue(units) === "0.00") {
                            unitColor = "#8c99ad";
                        }
                        
                        // Parse CLV value and format it
                        let clvValue = parseFloat(row.clv.replace("%", ""));
                        let formattedClv = formatValue(clvValue, true);
                        let clvColor = clvValue > 0 ? "#1ea672" : clvValue < 0 ? "#ff5252" : "#8c99ad";
                        
                        tr.innerHTML = `
            <td style="color: #8c99ad; text-align: center;"><span class="date">${row.date}</span>${row.sport}</td>
            <td style="color: #8c99ad;">${row.play}</td>
            <td style="color: ${row.result === "Win" ? "#1ea672" : row.result === "Loss" ? "#ff5252" : "#8c99ad"}; text-align: center;">${row.result}</td>
            <td style="color: ${unitColor}; text-align: center;">${formatValue(units)}</td>
            <td style="color: #8c99ad; text-align: center;">${row.score}</td>
            <td style="color: #8c99ad; text-align: center;">${row.close}</td>
            <td style="color: ${clvColor}; text-align: right;">${formattedClv}</td>
        `;
                        tbody.appendChild(tr);
                        console.log("Row added:", tr);
                    });
                    console.log("Table population complete. Total rows:", tbody.children.length);
                }

                function createSimpleChart() {
                    var chartData = data.reduce((acc, row) => {
                        var date = new Date(row.date);
                        var dateString = date.toISOString().split("T")[0];
                        if (!acc[dateString]) {
                            acc[dateString] = { date: date, units: 0 };
                        }
                        acc[dateString].units += calculateUnits(row);
                        return acc;
                    }, {});

                    var chartDataArray = Object.values(chartData).sort((a, b) => a.date - b.date);
                    var labels = ["\u00A0"].concat(
                        chartDataArray.map((item) => {
                            var date = new Date(item.date);
                            return `${date.toLocaleString("en-US", { month: "short" })} ${date.getUTCDate()}`;
                        })
                    );
                    var cumulativeUnits = chartDataArray.reduce(
                        (cumulative, item, index) => {
                            var total = index === 0 ? item.units : cumulative[cumulative.length - 1] + item.units;
                            cumulative.push(total);
                            return cumulative;
                        },
                        [0]
                    );

                    var ctx = document.getElementById("myChart").getContext("2d");
                    window.myChart = new Chart(ctx, {
                        type: "line",
                        data: {
                            labels: labels,
                            datasets: [
                                {
                                    label: "Cumulative Units",
                                    data: cumulativeUnits,
                                    borderColor: "rgba(0, 128, 128, 1)",
                                    backgroundColor: "rgba(0, 128, 128, 0.2)",
                                    fill: true,
                                    lineTension: 0,
                                    pointRadius: 0,
                                    pointStyle: "circle",
                                    pointBackgroundColor: "#1ea672",
                                    pointBorderColor: "#1ea672",
                                    pointBorderWidth: 1,
                                    pointHoverRadius: 3,
                                    pointHoverBackgroundColor: "#1ea672",
                                    pointHoverBorderColor: "#1ea672",
                                    pointHoverBorderWidth: 2,
                                    responsive: true
                                }
                            ]
                        },
                        options: {
                            scales: {
                                x: {
                                    display: false,
                                    grid: {
                                        display: false
                                    },
                                    ticks: {
                                        color: "#8c99ad"
                                    }
                                },
                                y: {
                                    display: true,
                                    grid: {
                                        display: false
                                    },
                                    ticks: {
                                        color: "#8c99ad"
                                    }
                                }
                            },
                            plugins: {
                                legend: {
                                    display: false
                                },
                                tooltip: {
                                    mode: "index",
                                    intersect: false,
                                    displayColors: false,
                                    callbacks: {
                                        title: function (tooltipItems) {
                                            if (tooltipItems[0].dataIndex === 0) {
                                                return "\u00A0";
                                            }
                                            var date = new Date(chartDataArray[tooltipItems[0].dataIndex - 1].date);
                                            return `${date.toLocaleString("en-US", { month: "short" })} ${date.getUTCDate()}`;
                                        },
                                        label: function (context) {
                                            return "‚óè  Units: " + context.parsed.y.toFixed(2);
                                        }
                                    }
                                }
                            },
                            layout: {
                                padding: 0
                            }
                        }
                    });
                }

                document.querySelector(".search-bar").addEventListener("input", filterSidebar);
                updateSummaryTable();
                populateDetailedTable();
                createSimpleChart();
            });
        </script>
        <script src="https://cdn.jsdelivr.net/npm/decimal.js@10.3.1/decimal.min.js"></script>
    </body>
</html>
