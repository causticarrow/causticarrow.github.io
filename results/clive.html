<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Clive Results - causticarrow.com</title>
        <link rel="stylesheet" href="../style.css" />
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    </head>
    <body>
        <div class="container">
<aside class="sidebar">
    <input type="text" class="search-bar" placeholder="Search" />
    <ul>
        <li><a href="../index.html">Home</a></li>
        <li><a href="https://x.com/causticarrow">ùïè (Twitter)</a></li>

<li class="category-header">
    <span class="category-toggle">Results</span>
    <ul class="category-content">
        <li><a href="clive.html" class="active">Clive</a></li>
    </ul>
</li>
    </ul>
</aside>
            <main class="main-content">
                <div id="chart-container" style="width: 100%; height: 300px">
                    <canvas id="myChart" style="width: 100%; height: 300px"></canvas>
                </div>
<table class="summary-table">
    <thead>
        <tr>
            <th>n</th>
            <th>Record</th>
            <th>Units</th>
            <th>ROI</th> <!-- New ROI column -->
            <th>BTCL</th>
            <th>No-Vig CLV</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td id="n"></td>
            <td id="record"></td>
            <td id="units"></td>
            <td id="roi"></td> <!-- New ROI column -->
            <td id="btcl"></td>
            <td id="noVigClv"></td>
        </tr>
    </tbody>
</table>
                <table class="detailed-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Play</th>
                            <th>Result</th>
                            <th>Units</th>
                            <th>Score</th>
                            <th>Close</th>
                            <th>CLV</th>
                        </tr>
                    </thead>
                    <tbody id="resultsTableBody"></tbody>
                </table>
            </main>
        </div>

        <script>
document.addEventListener("DOMContentLoaded", function () {
    var data = [
                    {date: "2025-01-12",sport: "NFL",play: "Green Bay TT Under 20.5 vs. Philadelphia (-105)",result: "Win",score: "10",close: "-135",clv: "4.63%"},
{date: "2024-12-30",sport: "NFL",play: "Detroit TT Over 27.5 vs. San Francisco",result: "Win",score: "40",close: "-120",clv: "0.52%"},
{date: "2024-12-26",sport: "NFL",play: "Seattle/Chicago Under 42.5",result: "Win",score: "6-3",close: "-110",clv: "-2.79%"},
{date: "2024-12-25",sport: "NFL",play: "Baltimore -3.5 vs. Houston",result: "Win",score: "31-2",close: "-161.1",clv: "8.00%"},
{date: "2024-12-22",sport: "NFL",play: "Atlanta TT Over 24.5 vs. NY Giants (-120)",result: "Win",score: "34",close: "-154.4",clv: "4.60%"},
{date: "2024-12-21",sport: "NFL",play: "Pittsburgh/Baltimore Under 46.5",result: "Loss",score: "17-34",close: "-149",clv: "5.90%"},
{date: "2024-12-15",sport: "NFL",play: "Indianapolis/Denver Under 43.5",result: "Loss",score: "13-31",close: "-116.9",clv: "-0.14%"},
{date: "2024-12-15",sport: "NFL",play: "Pittsburgh/Philadelphia Under 44",result: "Win",score: "13-27",close: "-128.1",clv: "2.16%"},
{date: "2024-12-15",sport: "NFL",play: "Baltimore TT Over 28.5 vs. NY Giants (-120)",result: "Win",score: "35",close: "-144",clv: "2.90%"},
{date: "2024-12-08",sport: "NFL",play: "Miami TT Over 26.5 vs. NY Jets (+100)",result: "Win",score: "32",close: "-135",clv: "5.85%"},
{date: "2024-12-01",sport: "NFL",play: "Tampa Bay TT Over 26.5 vs. Carolina",result: "Loss",score: "26 OT",close: "-121",clv: "0.73%"},
{date: "2024-12-01",sport: "NFL",play: "LA Chargers -1.5 vs. Atlanta (-105)",result: "Win",score: "17-13",close: "-103.5",clv: "-1.82%"},
{date: "2024-11-24",sport: "NFL",play: "Minnesota -3 vs. Chicago (-120)",result: "Push",score: "30-27 OT",close: "-108",clv: "-4.07%"},
{date: "2024-11-10",sport: "NFL",play: "NY Giants/Carolina Under 41.5 (-105)",result: "Win",score: "17-20 OT",close: "-139",clv: "5.35%"},
{date: "2024-11-03",sport: "NFL",play: "New England/Tennessee Under 38.5",result: "Win",score: "17-20",close: "-115",clv: "-0.55%"},
{date: "2024-10-31",sport: "NFL",play: "Houston/NY Jets Under 42.5",result: "Win",score: "13-21",close: "104",clv: "-5.10%"},
{date: "2024-10-27",sport: "NFL",play: "Dallas/San Francisco Under 48",result: "Loss",score: "24-30",close: "-117.6",clv: "0.01%"},
{date: "2024-10-27",sport: "NFL",play: "Cincinnati -2.5 vs. Philadelphia",result: "Loss",score: "17-37",close: "-129.7",clv: "2.70%"},
{date: "2024-10-17",sport: "NFL",play: "Denver/New Orleans Over 37",result: "Win",score: "33-10",close: "-110",clv: "-1.68%"},
{date: "2024-10-13",sport: "NFL",play: "Atlanta TT Over 27.5 vs. Carolina (+110)",result: "Win",score: "38",close: "110",clv: "-1.76%"},
{date: "2024-10-13",sport: "NFL",play: "Arizona/Green Bay Under 50 (-115)",result: "Win",score: "13-34",close: "-159.3",clv: "6.41%"},
{date: "2024-10-07",sport: "NFL",play: "New Orleans/Kansas City Under 42.5",result: "Win",score: "13-26",close: "-103.6",clv: "-3.20%"},
{date: "2024-09-29",sport: "NFL",play: "Pittsburgh -1.5 vs. Indianapolis",result: "Loss",score: "24-27",close: "-119.6",clv: "0.67%"},
{date: "2024-09-22",sport: "NFL",play: "Detroit/Arizona Under 52",result: "Win",score: "20-13",close: "-118.5",clv: "0.20%"},
{date: "2024-09-15",sport: "NFL",play: "LA Rams/Arizona Over 49",result: "Win",score: "10-41",close: "117",clv: "-8.08%"},
{date: "2024-09-15",sport: "NFL",play: "Cleveland/Jacksonville Under 42",result: "Win",score: "18-13",close: "-123.4",clv: "1.22%"},
{date: "2024-09-12",sport: "NFL",play: "Buffalo/Miami Under 50.5",result: "Win",score: "31-10",close: "-124.3",clv: "1.40%"}
                ];

console.log("Data before processing:", data);

function formatValue(value, isPercentage = false) {
        if (isPercentage) {
            return value > 0 ? `+${value.toFixed(2)}%` : value < 0 ? `${value.toFixed(2)}%` : "0.00%";
        } else {
            return value > 0 ? `+${value.toFixed(2)}` : value < 0 ? `${value.toFixed(2)}` : "0.00";
        }
    }

function filterSidebar() {
    var input, filter, ul, li, a, i, txtValue;
    input = document.querySelector('.search-bar');
    filter = input.value.toUpperCase();
    ul = document.querySelector('.sidebar ul');
    li = ul.getElementsByTagName('li');

    for (i = 0; i < li.length; i++) {
        a = li[i].getElementsByTagName("a")[0];
        if (a) {
            txtValue = a.textContent || a.innerText;
            if (txtValue.toUpperCase().indexOf(filter) > -1) {
                li[i].style.display = "";
            } else {
                li[i].style.display = "none";
            }
        }
    }
}

function calculateUnits(row) {
    console.log("Processing row for units:", row);
    if (row.result === "Win") {
        console.log("Win detected, returning 1 unit");
        return 1; 
    } else if (row.result === "Loss") {
        if (row.play.includes("(")) {
            console.log("Odds found in play:", row.play);
            var oddsMatch = row.play.match(/\(([-+]?\d+(?:\.\d+)?)\)/);
            if (oddsMatch) {
                var odds = parseFloat(oddsMatch[1]);
                console.log("Parsed odds:", odds);
                if (odds > 0) {
                    console.log("Positive odds calculation:", -(100 / odds));
                    return -(100 / odds);
                } else {
                    console.log("Negative odds calculation:", -(Math.abs(odds) / 100));
                    return -(Math.abs(odds) / 100);
                }
            } else {
                console.log("No odds format found, returning default loss");
                return -1.1; 
            }
        } else {
            console.log("No odds found, returning default loss");
            return -1.1; 
        }
    } else {
        console.log("Push or other result, returning 0");
        return 0; 
    }
}

function calculateRisk(row) {
    console.log("Processing row for risk:", row);
    if (row.play.includes("(")) {
        console.log("Odds found in play:", row.play);
        var oddsMatch = row.play.match(/\(([-+]?\d+(?:\.\d+)?)\)/);
        if (oddsMatch) {
            var odds = parseFloat(oddsMatch[1]);
            console.log("Parsed odds:", odds);
            if (odds > 0) {
                console.log("Positive odds risk calculation:", odds / 100);
                return odds / 100;
            } else {
                console.log("Negative odds risk calculation:", Math.abs(odds) / 100);
                return Math.abs(odds) / 100;
            }
        } else {
            console.log("No odds format found, returning default risk");
            return 1.1; 
        }
    } else {
        console.log("No odds found, returning default risk");
        return 1.1; 
    }
}

function updateSummaryTable() {
        let wins = 0, losses = 0, pushes = 0, totalUnits = 0, positiveClv = 0, totalClv = 0, totalRisked = 0;
        
        data.forEach((row) => {
            if (row.result === "Win") {
                wins++;
                let units = calculateUnits(row);
                if (isNaN(units)) {
                    console.error("NaN detected in units calculation for:", row);
                } else {
                    totalUnits += units;
                }
            } else if (row.result === "Loss") {
                losses++;
                let units = calculateUnits(row);
                if (isNaN(units)) {
                    console.error("NaN detected in units calculation for:", row);
                } else {
                    totalUnits += units;
                }
            } else if (row.result === "Push") {
                pushes++;
            }
            let risk = calculateRisk(row);
            if (isNaN(risk)) {
                console.error("NaN detected in risk calculation for:", row);
            } else {
                totalRisked += risk;
            }
            if (parseFloat(row.clv.replace("%", "")) > 0) positiveClv++;
            totalClv += parseFloat(row.clv.replace("%", ""));
        });

        console.log("Summary stats:", {wins, losses, pushes, totalUnits, totalRisked, positiveClv, totalClv});

        // Check if elements exist before setting content
        let nElement = document.getElementById("n");
        let recordElement = document.getElementById("record");
        let unitsElement = document.getElementById("units");
        let roiElement = document.getElementById("roi");
        let btclElement = document.getElementById("btcl");
        let noVigClvElement = document.getElementById("noVigClv");

        if (nElement) nElement.textContent = data.length;
        if (recordElement) recordElement.textContent = `${wins} - ${losses} - ${pushes} (${((wins / (wins + losses + pushes)) * 100).toFixed(2)}%)`;
        
        if (unitsElement) {
            unitsElement.textContent = formatValue(totalUnits);
            console.log("Units element content set to:", unitsElement.textContent);
            unitsElement.style.color = totalUnits > 0 ? "#1ea672" : totalUnits < 0 ? "#ff5252" : "#8c99ad";
        }
        
        // Calculate ROI
        if (roiElement) {
            let roi = (totalUnits / totalRisked) * 100;
            roiElement.textContent = formatValue(roi, true);
            console.log("ROI element content set to:", roiElement.textContent);
            roiElement.style.color = roi > 0 ? "#1ea672" : roi < 0 ? "#ff5252" : "#8c99ad";
        }
        
        if (btclElement) btclElement.textContent = `${((positiveClv / data.length) * 100).toFixed(2)}%`;

        if (noVigClvElement) {
            noVigClvElement.textContent = formatValue(totalClv / data.length, true);
            console.log("No-Vig CLV element content set to:", noVigClvElement.textContent);
            noVigClvElement.style.color = parseFloat(noVigClvElement.textContent.replace("%", "")) > 0 ? "#1ea672" : "#ff5252";
        }
    }

function populateDetailedTable() {
    let tbody = document.getElementById("resultsTableBody");
    if (!tbody) {
        console.error("Table body not found");
        return;
    }
    console.log("Table body found, clearing and repopulating", tbody);
    tbody.innerHTML = "";

    console.log("Data before sort:", data);
    data.sort((a, b) => {
        var dateA = new Date(a.date).getTime();
        var dateB = new Date(b.date).getTime();

        if (dateA === dateB) {
            var rotationA = a.play.match(/^\d+/) ? parseInt(a.play.match(/^\d+/)[0]) : 0;
            var rotationB = b.play.match(/^\d+/) ? parseInt(b.play.match(/^\d+/)[0]) : 0;
            return rotationB - rotationA;
        }

        return dateB - dateA;
    });
    console.log("Data after sort:", data);

    data.forEach((row, index) => {
        console.log("Processing row for detailed table:", index, row);
        let units = calculateUnits(row);
        let tr = document.createElement("tr");
        let unitColor = units > 0 ? "#1ea672" : units < 0 ? "#ff5252" : "#8c99ad";
        if (formatValue(units) === "0.00") {
            unitColor = "#8c99ad";
        }
        tr.innerHTML = `
            <td style="color: #8c99ad; text-align: center;"><span class="date">${row.date}</span>${row.sport}</td>
            <td style="color: #8c99ad;">${row.play}</td>
            <td style="color: ${row.result === "Win" ? "#1ea672" : row.result === "Loss" ? "#ff5252" : "#8c99ad"}; text-align: center;">${row.result}</td>
            <td style="color: ${unitColor}; text-align: center;">${formatValue(units)}</td>
            <td style="color: #8c99ad; text-align: center;">${row.score}</td>
            <td style="color: #8c99ad; text-align: center;">${row.close}</td>
            <td style="color: ${parseFloat(row.clv) > 0 ? "#1ea672" : parseFloat(row.clv) < 0 ? "#ff5252" : "#8c99ad"}; text-align: right;">${formatValue(parseFloat(row.clv), true)}</td>
        `;
        tbody.appendChild(tr);
        console.log("Row added:", tr);
    });
    console.log("Table population complete. Total rows:", tbody.children.length);
}

function populateDetailedTable() {
    let tbody = document.getElementById("resultsTableBody");
    if (!tbody) {
        console.error("Table body not found");
        return;
    }
    console.log("Table body found, clearing and repopulating", tbody);
    tbody.innerHTML = "";

    console.log("Data before sort:", data);
    data.sort((a, b) => {
        var dateA = new Date(a.date).getTime();
        var dateB = new Date(b.date).getTime();

        if (dateA === dateB) {
            // Try to extract rotation number, but handle cases where it might not exist or be in the wrong format
            var rotationA = a.play.match(/^\d+/) ? parseInt(a.play.match(/^\d+/)[0]) : 0;
            var rotationB = b.play.match(/^\d+/) ? parseInt(b.play.match(/^\d+/)[0]) : 0;
            return rotationB - rotationA;
        }

        return dateB - dateA;
    });
    console.log("Data after sort:", data);

    data.forEach((row, index) => {
        console.log("Processing row:", index, row);
        let units = calculateUnits(row);
        let tr = document.createElement("tr");
        let unitColor = units > 0 ? "#1ea672" : units < 0 ? "#ff5252" : "#8c99ad";
        if (formatValue(units) === "0.00") {
            unitColor = "#8c99ad";
        }
        tr.innerHTML = `
            <td style="color: #8c99ad; text-align: center;"><span class="date">${row.date}</span>${row.sport}</td>
            <td style="color: #8c99ad;">${row.play}</td>
            <td style="color: ${row.result === "Win" ? "#1ea672" : row.result === "Loss" ? "#ff5252" : "#8c99ad"}; text-align: center;">${row.result}</td>
            <td style="color: ${unitColor}; text-align: center;">${formatValue(units)}</td>
            <td style="color: #8c99ad; text-align: center;">${row.score}</td>
            <td style="color: #8c99ad; text-align: center;">${row.close}</td>
            <td style="color: ${parseFloat(row.clv) > 0 ? "#1ea672" : parseFloat(row.clv) < 0 ? "#ff5252" : "#8c99ad"}; text-align: right;">${formatValue(parseFloat(row.clv), true)}</td>
        `;
        tbody.appendChild(tr);
        console.log("Row added:", tr);
    });
    console.log("Table population complete. Total rows:", tbody.children.length);
}

                // Simple Chart Function
function createSimpleChart() {
    var chartData = data.reduce((acc, row) => {
        var date = new Date(row.date);
        var dateString = date.toISOString().split("T")[0];
        if (!acc[dateString]) {
            acc[dateString] = { date: date, units: 0 };
        }
        acc[dateString].units += calculateUnits(row);
        return acc;
    }, {});

    var chartDataArray = Object.values(chartData).sort((a, b) => a.date - b.date);
    var labels = ["\u00A0"].concat( // Using \u00A0 for a non-breaking space to replace "Start"
        chartDataArray.map((item) => {
            var date = new Date(item.date);
            return `${date.toLocaleString("en-US", { month: "short" })} ${date.getUTCDate()}`;
        })
    );
    var cumulativeUnits = chartDataArray.reduce(
        (cumulative, item, index) => {
            var total = index === 0 ? item.units : cumulative[cumulative.length - 1] + item.units;
            cumulative.push(total);
            return cumulative;
        },
        [0]
    );

    var ctx = document.getElementById("myChart").getContext("2d");
    window.myChart = new Chart(ctx, {
        type: "line",
        data: {
            labels: labels,
            datasets: [
                {
                    label: "Cumulative Units",
                    data: cumulativeUnits,
                    borderColor: "rgba(0, 128, 128, 1)",
                    backgroundColor: "rgba(0, 128, 128, 0.2)",
                    fill: true,
                    lineTension: 0,
                    pointRadius: 0,
                    pointStyle: "circle",
                    pointBackgroundColor: "#1ea672",
                    pointBorderColor: "#1ea672",
                    pointBorderWidth: 1,
                    pointHoverRadius: 3,
                    pointHoverBackgroundColor: "#1ea672",
                    pointHoverBorderColor: "#1ea672",
                    pointHoverBorderWidth: 2,
                    responsive: true
                }
            ]
        },
        options: {
            scales: {
                x: {
                    display: true,
                    grid: {
                        display: false
                    },
                    ticks: {
                        color: '#8c99ad' // Font color for x-axis labels
                    }
                },
                y: {
                    display: true,
                    grid: {
                        display: false
                    },
                    ticks: {
                        color: '#8c99ad' // Font color for y-axis labels
                    }
                }
            },
            plugins: {
                legend: {
                    display: false
                },
                tooltip: {
                    mode: "index",
                    intersect: false,
                    displayColors: false,
                    callbacks: {
                        title: function (tooltipItems) {
                            if (tooltipItems[0].dataIndex === 0) {
                                return "\u00A0"; // Non-breaking space for "Start" tooltip
                            }
                            var date = new Date(chartDataArray[tooltipItems[0].dataIndex - 1].date);
                            return `${date.toLocaleString("en-US", { month: "short" })} ${date.getUTCDate()}`;
                        },
                        label: function (context) {
                            return "‚óè  Units: " + context.parsed.y.toFixed(2);
                        }
                    }
                }
            },
            layout: {
                padding: 0
            }
        }
    });
}

document.querySelector('.search-bar').addEventListener('input', filterSidebar);
                // Call functions
                updateSummaryTable();
                populateDetailedTable();
                createSimpleChart();
            });
        </script>
        <script src="https://cdn.jsdelivr.net/npm/decimal.js@10.3.1/decimal.min.js"></script>
    </body>
</html>