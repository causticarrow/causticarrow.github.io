<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Results - causticarrow.com</title>
    <link rel="stylesheet" href="../style.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  </head>
  <body>
    <div class="container">
      <aside class="sidebar">
        <input type="text" class="search-bar" placeholder="Search" />
        <ul>
          <li><a href="../index.html">Home</a></li>
          <li><a href="https://x.com/causticarrow">ùïè (Twitter)</a></li>
          <li class="category-header">
            <span class="category-toggle">Results</span>
            <ul class="category-content" id="results-list"></ul>
          </li>
        </ul>
      </aside>
      <main class="main-content">
        <h1 id="pageHeader">Results</h1>
        <div id="chart-container" style="width: 100%; height: 300px">
          <canvas id="myChart" style="width: 100%; height: 300px"></canvas>
        </div>
        <table class="summary-table">
          <thead>
            <tr>
              <th>n</th>
              <th>Record</th>
              <th>Units</th>
              <th>ROI</th>
              <th>BTCL</th>
              <th>No-Vig CLV</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td id="n"></td>
              <td id="record"></td>
              <td id="units"></td>
              <td id="roi"></td>
              <td id="btcl"></td>
              <td id="noVigClv"></td>
            </tr>
          </tbody>
        </table>
        <table class="detailed-table">
          <thead>
            <tr>
              <th>Date</th>
              <th>Play</th>
              <th>Result</th>
              <th>Units</th>
              <th>Score</th>
              <th>Close</th>
              <th>No-Vig CLV</th>
            </tr>
          </thead>
          <tbody id="resultsTableBody"></tbody>
        </table>
      </main>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // -------------------------
        // Auto-config from filename
        // -------------------------
        function getConfigFromFilename() {
          const fileName = window.location.pathname.split("/").pop().replace(".html", "");
          const parts = fileName.split("-");

          let name = "";
          let sport = "";
          let year = "";

          if (parts.length === 1) {
            // Only name
            name = parts[0];
          } else if (parts.length === 2) {
            // e.g. alexcaruso-2024-25.html
            name = parts[0];
            year = parts[1];
          } else if (parts.length >= 3) {
            // e.g. CliveBixby41-NFL-2024-25.html
            name = parts[0];
            sport = parts[1];
            year = parts.slice(2).join("-");
          }

          return { name, sport, year };
        }

        const config = getConfigFromFilename();

        // -------------------------
        // Example data (replace with real data)
        // -------------------------
        var data = [
{date: "2024-06-07",sport: "CBASE",play: "3183 Evansville +4.5 vs. Tennessee",result: "Loss",score: "6-11",close: "-125",clv: "-0.24%"},
{date: "2024-06-01",sport: "CBASE",play: "3337 Grand Canyon/West Virginia Over 11.5 (-115)",result: "Loss",score: "2-5 (7)",close: "-185",clv: "8.35%"},
{date: "2024-06-01",sport: "CBASE",play: "3326 Oklahoma State/Florida Under 14 (-115)",result: "Win",score: "7-1 (8)",close: "-220",clv: "12.33%"},
{date: "2024-06-01",sport: "CBASE",play: "3264 Vanderbilt/High Point Under 13.5 (-120)",result: "Loss",score: "9-10 (19)",close: "-210",clv: "10.23%"},
{date: "2024-05-31",sport: "CBASE",play: "3244 West Virginia/Dallas Baptist Under 10.5 (-115)",result: "Win",score: "4-1 (5)",close: "-165",clv: "5.60%"},
{date: "2023-06-22",sport: "CBASE",play: "3435 Wake Forest +1.5 (-125) vs. LSU",result: "Loss",score: "0-2",close: "-145",clv: "0.34%"},
{date: "2023-06-16",sport: "CBASE",play: "3402 Oral Roberts/TCU Under 13 (-115)",result: "Win",score: "6-5 (11)",close: "-130",clv: "-0.35%"},
{date: "2023-06-11",sport: "CBASE",play: "3453 Stanford PK (-125) vs. Texas",result: "Win",score: "8-3",close: "-160",clv: "2.78%"},
{date: "2023-06-10",sport: "CBASE",play: "3416 Texas/Stanford Under 13 (-120)",result: "Win",score: "7-5 (12)",close: "-175",clv: "5.97%"},
{date: "2023-06-10",sport: "CBASE",play: "3413 Tennessee/Southern Miss Over 9.5 (-105)",result: "Loss",score: "3-5 (8)",close: "-155",clv: "6.34%"},
{date: "2023-06-10",sport: "CBASE",play: "3410 Alabama/Wake Forest Under 11 (-120)",result: "Win",score: "4-5 (9)",close: "-180",clv: "6.64%"},
{date: "2023-06-09",sport: "CBASE",play: "3406 Florida PK (-145) vs. South Carolina",result: "Win",score: "5-4",close: "-190",clv: "3.28%"},
{date: "2023-06-04",sport: "CBASE",play: "3770 East Carolina/Virginia Under 13 (-115)",result: "Win",score: "3-8 (11)",close: "-170",clv: "6.33%"},
{date: "2023-06-03",sport: "CBASE",play: "3540 Vanderbilt -1.5 (+105) vs. Oregon",result: "Loss",score: "7-8",close: "-165",clv: "10.31%"},
{date: "2023-06-02",sport: "CBASE",play: "3452 Eastern Illinois/Vanderbilt Under 13.5 (-125)",result: "Loss",score: "2-12 (14)",close: "-305",clv: "17.09%"},
{date: "2023-06-02",sport: "CBASE",play: "3436 Florida -5.5 (-120) vs. Florida A&M",result: "Loss",score: "3-0",close: "-170",clv: "5.27%"},
{date: "2023-06-02",sport: "CBASE",play: "3430 Lipscomb/Clemson Under 12.5 (-120)",result: "Loss",score: "5-12 (17)",close: "-265",clv: "15.28%"},
{date: "2023-06-02",sport: "CBASE",play: "3421 Ball State/Kentucky Over 10 (-115)",result: "Loss",score: "0-4 (4)",close: "-340",clv: "21.20%"},
{date: "2023-06-02",sport: "CBASE",play: "3404 George Mason/Wake Forest Under 13.5 (-120)",result: "Win",score: "0-12 (12)",close: "-250",clv: "14.06%"},
{date: "2023-06-02",sport: "CBASE",play: "3401 Northeastern/Maryland Over 13.5 (-120)",result: "Loss",score: "2-7 (9)",close: "-200",clv: "9.11%"},
{date: "2022-06-11",sport: "CBASE",play: "3524 Auburn/Oregon State Under 10.5 (-115)",result: "Loss",score: "7-5 (12)",close: "-160",clv: "4.85%"},
{date: "2022-06-11",sport: "CBASE",play: "3512 Arkansas/North Carolina Under 11",result: "Win",score: "4-1 (5)",close: "-170",clv: "7.43%"},
{date: "2022-06-05",sport: "CBASE",play: "3610 Southern Miss -1.5 (-140) vs. Kennesaw State",result: "Loss",score: "4-3",close: "-185",clv: "3.50%"},
{date: "2022-06-05",sport: "CBASE",play: "3609 Kennesaw State/Southern Miss Over 11.5 (-115)",result: "Loss",score: "3-4 (7)",close: "-245",clv: "14.68%"},
{date: "2022-06-05",sport: "CBASE",play: "3589 Stanford PK vs. UC Santa Barbara (-165)",result: "Win",score: "8-4",close: "-225",clv: "4.05%"},
{date: "2022-06-05",sport: "CBASE",play: "3573 UL Lafayette/TCU Over 11.5",result: "Loss",score: "1-6 (7)",close: "-755",clv: "33.92%"},
{date: "2022-06-05",sport: "CBASE",play: "3561 Georgia Southern/Texas Tech Over 11 (-115)",result: "Loss",score: "1-3 (4)",close: "-445",clv: "25.78%"},
{date: "2022-06-04",sport: "CBASE",play: "3537 UCLA/SE Louisiana Over 10.5 (-120)",result: "Win",score: "16-2 (18)",close: "-190",clv: "7.92%"},
{date: "2022-06-04",sport: "CBASE",play: "3537 UCLA -2.5 (-125) vs. SE Louisiana",result: "Win",score: "16-2",close: "-165",clv: "3.53%"},
{date: "2022-06-04",sport: "CBASE",play: "3533 Kennesaw State/Army Over 11.5 (-120)",result: "Win",score: "9-8 (17)",close: "-175",clv: "5.97%"},
{date: "2022-06-04",sport: "CBASE",play: "3528 Oklahoma State PK (-145) vs. Arkansas",result: "Loss",score: "12-20",close: "-195",clv: "3.89%"},
{date: "2022-06-04",sport: "CBASE",play: "3528 Arkansas/Oklahoma State Under 11.5",result: "Loss",score: "20-12 (32)",close: "-185",clv: "9.45%"},
{date: "2022-06-04",sport: "CBASE",play: "3520 Maryland/Connecticut Under 14.5 (-115)",result: "Loss",score: "5-10 (15)",close: "-225",clv: "12.83%"},
{date: "2022-06-04",sport: "CBASE",play: "3516 Texas State/Stanford Under 13 (-115)",result: "Win",score: "5-2 (7)",close: "-185",clv: "8.35%"},
{date: "2022-06-04",sport: "CBASE",play: "3509 Gonzaga/Wright State Over 12.5 (-105)",result: "Win",score: "11-9 (20)",close: "-260",clv: "18.21%"},
{date: "2022-06-04",sport: "CBASE",play: "3489 Dallas Baptist PK (-145) vs. Air Force",result: "Loss",score: "1-5",close: "-185",clv: "2.65%"},
{date: "2022-06-04",sport: "CBASE",play: "3484 Tennessee/Campbell Under 13.5 (-115)",result: "Loss",score: "8-7 (15)",close: "-185",clv: "8.35%"},
{date: "2022-06-03",sport: "CBASE",play: "3462 New Mexico State/Oregon State Under 12 (-120)",result: "Win",score: "4-5 (9)",close: "-215",clv: "10.76%"},
{date: "2022-06-03",sport: "CBASE",play: "3440 Connecticut/Wake Forest Under 12.5",result: "Loss",score: "8-7 (15)",close: "-165",clv: "6.71%"},
{date: "2022-06-03",sport: "CBASE",play: "3423 Gonzaga PK (-220) vs. Columbia",result: "Loss",score: "2-8",close: "-310",clv: "4.20%"},
{date: "2022-06-03",sport: "CBASE",play: "3413 Coppin State +9.5 vs. East Carolina",result: "Loss",score: "1-17",close: "-155",clv: "5.18%"},
{date: "2021-06-20",sport: "CBASE",play: "3406 Virginia/Tennesse Under 9 (-125)",result: "Win",score: "6-0 (6)",close: "-215",clv: "9.75%"},
{date: "2021-06-12",sport: "CBASE",play: "3426 Ole Miss/Arizona Under 13.5 (120)",result: "Loss",score: "12-3 (15)",close: "-175",clv: "15.06%"},
{date: "2021-06-12",sport: "CBASE",play: "3426 Ole Miss PK (+135) vs. Arizona",result: "Win",score: "12-3",close: "-140",clv: "12.46%"},
{date: "2021-06-12",sport: "CBASE",play: "3423 Texas Tech PK (-140) vs. Stanford",result: "Loss",score: "0-9",close: "-170",clv: "1.48%"},
{date: "2021-06-11",sport: "CBASE",play: "3404 East Carolina/Vanderbilt Under 10 (-105)",result: "Win",score: "0-2 (2)",close: "-170",clv: "8.60%"},
{date: "2021-06-07",sport: "CBASE",play: "3683 Southern Miss PK (+175) vs. Ole Miss",result: "Loss",score: "9-12",close: "135",clv: "2.31%"},
{date: "2021-06-06",sport: "CBASE",play: "3639 South Alabama/South Florida Over 9 (-120)",result: "Loss",score: "4-0 (4)",close: "-175",clv: "5.97%"},
{date: "2021-06-06",sport: "CBASE",play: "3627 Maryland/East Carolina Over 11 (-120)",result: "Win",score: "6-9 (15)",close: "-200",clv: "9.11%"},
{date: "2021-06-06",sport: "CBASE",play: "3615 UCLA/Texas Tech Over 11.5 (-115)",result: "Loss",score: "2-8 (10)",close: "-170",clv: "6.33%"},
{date: "2021-06-06",sport: "CBASE",play: "3610 UC Irvine/North Dakota State Under 11 (+110)",result: "Loss",score: "18-3 (21)",close: "-190",clv: "14.84%"},
{date: "2021-06-05",sport: "CBASE",play: "3516 Fairfield -4.5 (-105) vs. Southern",result: "Loss",score: "6-2",close: "-165",clv: "7.87%"},
{date: "2021-06-05",sport: "CBASE",play: "3499 Oklahoma State/Grand Canyon Over 10 (-125)",result: "Loss",score: "5-3 (8)",close: "-195",clv: "7.51%"},
{date: "2021-06-05",sport: "CBASE",play: "3489 Stanford/UC Irvine Over 8.5 (-105)",result: "Win",score: "12-4 (16)",close: "-190",clv: "11.24%"},
{date: "2021-06-04",sport: "CBASE",play: "3439 South Alabama/Miami Florida Over 8.5 (-125)",result: "Loss",score: "0-1 (1)",close: "-170",clv: "4.26%"},
{date: "2021-06-04",sport: "CBASE",play: "3424 SE Missouri State/Ole Miss Under 12.5 (-120)",result: "Win",score: "3-6 (9)",close: "-170",clv: "5.27%"},
{date: "2021-06-04",sport: "CBASE",play: "3412 Nevada/UC Irvine Under 12.5",result: "Win",score: "0-7 (7)",close: "-145",clv: "3.52%"}
        ];

        // -------------------------
        // Sidebar auto-loader
        // -------------------------
        async function populateSidebar() {
          const ul = document.getElementById("results-list");
          ul.innerHTML = "";

          try {
            const response = await fetch("results.json");
            const pages = await response.json();

            const currentPage = window.location.pathname.split("/").pop();

            pages.forEach((p) => {
              const li = document.createElement("li");
              const a = document.createElement("a");
              a.href = p.file;
              a.textContent = p.label;

              // Highlight current page
              if (p.file === currentPage) {
                a.classList.add("active");
              }

              li.appendChild(a);
              ul.appendChild(li);
            });
          } catch (err) {
            console.error("Could not load results.json", err);
          }
        }

        // -------------------------
        // Title/Header
        // -------------------------
        function setTitleAndHeader() {
          var title =
            config.name +
            (config.year ? " " + config.year : "") +
            (config.sport ? " " + config.sport : "") +
            " Results - causticarrow.com";

          var header =
            (config.year ? config.year + " " : "") +
            (config.sport ? config.sport + " " : "") +
            "(" + config.name + ")";

          document.title = title;
          document.getElementById("pageHeader").textContent = header;
        }

        // -------------------------
        // Search filter
        // -------------------------
        function filterSidebar() {
          var input, filter, ul, li, i;
          input = document.querySelector(".search-bar");
          filter = input.value.toUpperCase();
          ul = document.querySelector(".sidebar ul");
          li = ul.getElementsByTagName("li");

          for (i = 0; i < li.length; i++) {
            var a = li[i].getElementsByTagName("a")[0];
            if (a) {
              var txtValue = li[i].textContent || li[i].innerText;
              if (txtValue.toUpperCase().indexOf(filter) > -1) {
                li[i].style.display = "";
              } else {
                var shouldHide = true;
                li[i].querySelectorAll("*").forEach((node) => {
                  if (
                    (node.textContent || node.innerText)
                      .toUpperCase()
                      .indexOf(filter) > -1
                  ) {
                    shouldHide = false;
                  }
                });
                li[i].style.display = shouldHide ? "none" : "";
              }
            }
          }
        }

        // -------------------------
        // Units & Risk Calculations
        // -------------------------
        function calculateUnits(row) {
          if (row.result === "Win") {
            return 1;
          } else if (row.result === "Loss") {
            if (row.play.includes("(")) {
              var oddsMatch = row.play.match(/\(([-+]?\d+(?:\.\d+)?)\)/);
              if (oddsMatch) {
                var odds = parseFloat(oddsMatch[1]);
                if (odds > 0) {
                  return -(100 / odds);
                } else {
                  return -(Math.abs(odds) / 100);
                }
              } else {
                return -1.1;
              }
            } else {
              return -1.1;
            }
          } else if (row.result === "Pending") {
            return null;
          } else {
            return 0;
          }
        }

        function calculateRisk(row) {
          if (row.play.includes("(")) {
            var oddsMatch = row.play.match(/\(([-+]?\d+(?:\.\d+)?)\)/);
            if (oddsMatch) {
              var odds = parseFloat(oddsMatch[1]);
              if (odds > 0) {
                return odds / 100;
              } else {
                return Math.abs(odds) / 100;
              }
            } else {
              return 1.1;
            }
          } else {
            return 1.1;
          }
        }

        function formatValue(value, isPercentage = false) {
          if (value === null) return "‚Äî";
          if (isPercentage) {
            if (value === 0) return "‚Äî";
            return value > 0
              ? `+${value.toFixed(2)}%`
              : `${value.toFixed(2)}%`;
          } else {
            return value > 0
              ? `+${value.toFixed(2)}`
              : value < 0
              ? `${value.toFixed(2)}`
              : "0.00";
          }
        }

        // -------------------------
        // Summary Table
        // -------------------------
        function updateSummaryTable() {
          let wins = 0,
            losses = 0,
            pushes = 0,
            totalUnits = 0,
            positiveClv = 0,
            totalClv = 0,
            totalRisked = 0;

          data.forEach((row) => {
            if (row.result === "Win") {
              wins++;
              totalUnits += calculateUnits(row);
            } else if (row.result === "Loss") {
              losses++;
              totalUnits += calculateUnits(row);
            } else if (row.result === "Push") {
              pushes++;
            }
            if (row.result !== "Pending") {
              totalRisked += calculateRisk(row);
              let clvValue = parseFloat(row.clv.replace("%", ""));
              if (clvValue > 0) positiveClv++;
              totalClv += clvValue;
            }
          });

          let nElement = document.getElementById("n");
          let recordElement = document.getElementById("record");
          let unitsElement = document.getElementById("units");
          let roiElement = document.getElementById("roi");
          let btclElement = document.getElementById("btcl");
          let noVigClvElement = document.getElementById("noVigClv");

          if (nElement) nElement.textContent = data.length;
          if (recordElement)
            recordElement.textContent = `${wins} - ${losses} - ${pushes} (${(
              (wins / (wins + losses)) *
              100
            ).toFixed(2)}%)`;

          if (unitsElement) {
            unitsElement.textContent = formatValue(totalUnits);
            unitsElement.style.color =
              totalUnits > 0
                ? "#1ea672"
                : totalUnits < 0
                ? "#ff5252"
                : "#8c99ad";
          }

          if (roiElement) {
            let roi = (totalUnits / totalRisked) * 100;
            roiElement.textContent = formatValue(roi, true);
            roiElement.style.color =
              roi > 0 ? "#1ea672" : roi < 0 ? "#ff5252" : "#8c99ad";
          }

          let settledBetsCount = data.filter(
            (row) => row.result !== "Pending"
          ).length;
          let btclPercent =
            settledBetsCount > 0 ? (positiveClv / settledBetsCount) * 100 : 0;
          if (btclElement) {
            btclElement.textContent = btclPercent === 0 ? "‚Äî" : `${btclPercent.toFixed(2)}%`;
          }

          if (noVigClvElement) {
            let avgClv = settledBetsCount > 0 ? totalClv / settledBetsCount : 0;
            noVigClvElement.textContent = formatValue(avgClv, true);
            noVigClvElement.style.color =
              avgClv > 0 ? "#1ea672" : avgClv < 0 ? "#ff5252" : "#8c99ad";
          }
        }

        // -------------------------
        // Detailed Table
        // -------------------------
        function populateDetailedTable() {
          let tbody = document.getElementById("resultsTableBody");
          tbody.innerHTML = "";

          data.sort((a, b) => new Date(b.date) - new Date(a.date));

          data.forEach((row) => {
            let units = calculateUnits(row);
            let tr = document.createElement("tr");
            let unitColor = "#8c99ad";
            let formattedUnits = formatValue(units);

            if (units !== null) {
              unitColor =
                units > 0 ? "#1ea672" : units < 0 ? "#ff5252" : "#8c99ad";
              if (formattedUnits === "0.00") unitColor = "#8c99ad";
            }

            let clvValue = parseFloat(row.clv.replace("%", ""));
            let formattedClv = formatValue(clvValue, true);
            let clvColor =
              clvValue > 0 ? "#1ea672" : clvValue < 0 ? "#ff5252" : "#8c99ad";

            tr.innerHTML = `
              <td style="color: #8c99ad; text-align: center;">
                <span class="date">${row.date}</span>${row.sport}
              </td>
              <td style="color: #8c99ad;">${row.play}</td>
              <td style="color: ${
                row.result === "Win"
                  ? "#1ea672"
                  : row.result === "Loss"
                  ? "#ff5252"
                  : "#8c99ad"
              }; text-align: center;">${row.result}</td>
              <td style="color: ${unitColor}; text-align: center;">${formattedUnits}</td>
              <td style="color: #8c99ad; text-align: center;">${row.score}</td>
              <td style="color: #8c99ad; text-align: center;">${row.close}</td>
              <td style="color: ${clvColor}; text-align: right;">${formattedClv}</td>
            `;
            tbody.appendChild(tr);
          });
        }

        // -------------------------
        // Chart
        // -------------------------
        function createSimpleChart() {
          var chartData = data.reduce((acc, row) => {
            var date = new Date(row.date);
            var dateString = date.toISOString().split("T")[0];
            if (!acc[dateString]) {
              acc[dateString] = { date: date, units: 0 };
            }
            acc[dateString].units += calculateUnits(row) || 0;
            return acc;
          }, {});

          var chartDataArray = Object.values(chartData).sort(
            (a, b) => a.date - b.date
          );
          var labels = ["\u00A0"].concat(
            chartDataArray.map((item) => {
              var date = new Date(item.date);
              return `${date.toLocaleString("en-US", {
                month: "short",
              })} ${date.getUTCDate()}`;
            })
          );
          var cumulativeUnits = chartDataArray.reduce(
            (cumulative, item, index) => {
              var total =
                index === 0
                  ? item.units
                  : cumulative[cumulative.length - 1] + item.units;
              cumulative.push(total);
              return cumulative;
            },
            [0]
          );

          var ctx = document.getElementById("myChart").getContext("2d");
          window.myChart = new Chart(ctx, {
            type: "line",
            data: {
              labels: labels,
              datasets: [
                {
                  label: "Cumulative Units",
                  data: cumulativeUnits,
                  borderColor: "rgba(0, 128, 128, 1)",
                  backgroundColor: "rgba(0, 128, 128, 0.2)",
                  fill: true,
                  lineTension: 0,
                  pointRadius: 0,
                  pointStyle: "circle",
                  pointBackgroundColor: "#1ea672",
                  pointBorderColor: "#1ea672",
                  pointBorderWidth: 1,
                  pointHoverRadius: 3,
                  pointHoverBackgroundColor: "#1ea672",
                  pointHoverBorderColor: "#1ea672",
                  pointHoverBorderWidth: 2,
                  responsive: true,
                },
              ],
            },
            options: {
              scales: {
                x: { display: false, grid: { display: false } },
                y: { display: true, grid: { display: false } },
              },
              plugins: {
                legend: { display: false },
                tooltip: {
                  mode: "index",
                  intersect: false,
                  displayColors: false,
                  callbacks: {
                    title: function (tooltipItems) {
                      if (tooltipItems[0].dataIndex === 0) return "\u00A0";
                      var date = new Date(
                        chartDataArray[tooltipItems[0].dataIndex - 1].date
                      );
                      return `${date.toLocaleString("en-US", {
                        month: "short",
                      })} ${date.getUTCDate()}`;
                    },
                    label: function (context) {
                      return "‚óè  Units: " + context.parsed.y.toFixed(2);
                    },
                  },
                },
              },
              layout: { padding: 0 },
            },
          });
        }

        // -------------------------
        // Init
        // -------------------------
        setTitleAndHeader();
        populateSidebar();
        document
          .querySelector(".search-bar")
          .addEventListener("input", filterSidebar);
        updateSummaryTable();
        populateDetailedTable();
        createSimpleChart();
      });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/decimal.js@10.3.1/decimal.min.js"></script>
  </body>
</html>
